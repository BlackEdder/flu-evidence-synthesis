context("ODE")

test_that("Return the correct ODE results", {
    data("age_sizes")
    data("vaccine_calendar")
    data("polymod_uk")
    data("mcmcsample")
    odes <- runSEIRModel( age_sizes[,1],
                  vaccine_calendar,
                  as.matrix(polymod_uk),
                  mcmcsample )
    # Highest densities around 125 days, so we better check a couple around then
    #paste("c(", paste(as.character(odes[100,]),collapse=", "), ")", sep="") 
    expect_that( as.numeric(odes[100,]), equals(c(1160.29815611962, 6651.54303696748, 14762.0587218382, 38640.5640137718, 48205.7611098923, 30699.171008947, 5038.38829144536, 24.6968035807556, 381.147892544313, 1567.18171893041, 3556.91858512515, 4580.56072507346, 5891.52233256964, 3662.10109127876, 0, 0, 0, 0, 0, 0, 0)))
    #paste("c(", paste(as.character(odes[125,]),collapse=", "), ")", sep="") 
    expect_that( as.numeric(odes[125,]), equals(c(2972.889441366, 15475.3586008999, 36156.6628793019, 62641.3500626147, 105472.377345004, 66785.4625576766, 12216.3713066405, 63.2276085737547, 885.358827022898, 3829.35555657518, 5745.47153673136, 9953.91418158275, 12589.5012810659, 8782.03691110781, 0, 0, 0, 0, 0, 0, 0)))
    #paste("c(", paste(as.character(odes[150,]),collapse=", "), ")", sep="") 
    expect_that( as.numeric(odes[150,]), equals(c(527.13439460105, 2579.40274757502, 6259.43155341605, 8326.56723514911, 16917.3546437955, 10694.9703021943, 2120.51713280515, 11.2077508736787, 147.480088198045, 662.333594129373, 762.661300126587, 1592.39345085831, 2002.10924865605, 1519.26249860887, 0, 0, 0, 0, 0, 0, 0)))
    #paste("c(", paste(as.character(odes[175,]),collapse=", "), ")", sep="")
    expect_that( as.numeric(odes[175,]), equals(c(43.5300237643213, 211.490118566854, 515.817292452149, 664.651978715041, 1380.51679689959, 872.094216392817, 174.671202722151, 0.925382847053637, 12.0885410370055, 54.5560077181041, 60.8365701976313, 129.77694021797, 162.694041789986, 125.010943743409, 0, 0, 0, 0, 0, 0, 0)))
})
